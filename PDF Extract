import re

# Given text
text = """
ACCOUNT NAME GOKUL ACCOUNT NUMBER 0012345678 ACCOUNT TYPE DEMAND DEPOSIT ACCOUNTSTATEMENT DATE 01 MAR 2024 CURRENCY AUD INTEREST PERIOD 1 MAR 2024 TO 31 MAR 2024 STATEMENT NUMBER 00155 PAGE NUMBER 3 of 3 TAXID Interest Statement 30 MAR Interest Accrued 14900000 0100000 163 31 MAR Interest Accrued 50000000 0100000 163
"""

# Extracting information using regular expressions and string manipulations
data = {}

# 1. Account Name
data['Account Name'] = re.search(r'ACCOUNT NAME ([A-Z ]+)', text).group(1).strip()

# 2. Account Number
data['Account Number'] = re.search(r'ACCOUNT NUMBER (\d+)', text).group(1)

# 3. Account Type
data['Account Type'] = re.search(r'ACCOUNT TYPE (.*?) ACCOUNTSTATEMENT DATE', text).group(1).strip()

# 4. Statement Date
data['Statement Date'] = re.search(r'STATEMENT DATE (\d+ \w+ \d+)', text).group(1)

# 5. Currency
data['Currency'] = re.search(r'CURRENCY ([A-Z]+)', text).group(1)

# 6. Interest Period
interest_period = re.search(r'INTEREST PERIOD (\d+ \w+ \d+) TO (\d+ \w+ \d+)', text)
data['Interest Period'] = interest_period.group(0)
data['Interest Period Start Date'] = interest_period.group(1)
data['Interest Period End Date'] = interest_period.group(2)
data['Interest Period End Date Short'] = ' '.join(interest_period.group(2).split()[:2])

# 7. Locate the line with keyword 6C and extract the entire line
line_with_end_date = re.search(rf'{data["Interest Period End Date Short"]}.*', text).group(0)

# Parsing the line
line_parts = line_with_end_date.split()

# 7a. Extract date part
data['Date'] = ' '.join(line_parts[:2])

# 7b. Extract Interest Based Balance
data['Interest Based Balance'] = line_parts[line_parts.index('Accrued') + 1]

# 7c. Extract Interest Rate
interest_rate = line_parts[line_parts.index('Accrued') + 2]
data['Interest Rate'] = f"{int(interest_rate) / 1000000:.6f}%"

# Print the results
print(data)
