import torch
from transformers import BertTokenizer, BertForSequenceClassification
from transformers import TextClassificationPipeline

# Load pre-trained FinBERT model and tokenizer
model_name = "yiyanghkust/finbert-tone"
tokenizer = BertTokenizer.from_pretrained(model_name)
model = BertForSequenceClassification.from_pretrained(model_name)

# Initialize the text classification pipeline
finbert_pipeline = TextClassificationPipeline(model=model, tokenizer=tokenizer, return_all_scores=True)

def analyze_financial_sentiment(text):
    results = finbert_pipeline(text)
    return results

# Example usage
if __name__ == "__main__":
    financial_statement = "The company's revenue has increased by 20% in the last quarter, outperforming the market expectations."
    sentiment_results = analyze_financial_sentiment(financial_statement)
    print(sentiment_results)
