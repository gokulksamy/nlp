import re

# Given text
text = """ACCOUNT NAME GOKUL ACCOUNT NUMBER 0012345678 ACCOUNT TYPE DEMAND DEPOSIT ACCOUNTSTATEMENT DATE 01 MAR 2024 CURRENCY AUD INTEREST PERIOD 1 MAR 2024 TO 31 MAR 2024 STATEMENT NUMBER 00155 PAGE NUMBER 3 of 3 TAXID Interest Statement 30 MAR Interest Accrued 14900000 0100000 163 31 MAR Interest Accrued 50000000 0100000 163"""

# Define a function to extract required details
def extract_details(text):
    details = {}

    # Extract Account Name
    details['Account Name'] = re.search(r'ACCOUNT NAME (\w+)', text).group(1)

    # Extract Account Number
    details['Account Number'] = re.search(r'ACCOUNT NUMBER (\d+)', text).group(1)

    # Extract Account Type
    details['Account Type'] = re.search(r'ACCOUNT TYPE ([A-Z ]+)', text).group(1).strip()

    # Extract Statement Date
    details['Statement Date'] = re.search(r'DATE (\d+ \w+ \d+)', text).group(1)

    # Extract Currency
    details['Currency'] = re.search(r'CURRENCY (\w+)', text).group(1)

    # Extract Interest Period
    interest_period = re.search(r'INTEREST PERIOD (\d+ \w+ \d+) TO (\d+ \w+ \d+)', text)
    details['Interest Period Start Date'] = interest_period.group(1)
    details['Interest Period End Date'] = interest_period.group(2)
    details['Interest Period End Date Short'] = ' '.join(details['Interest Period End Date'].split()[:2])

    # Locate the line with keyword 6C (end date short)
    end_date_short = details['Interest Period End Date Short']
    required_line_match = re.search(rf'{end_date_short} Interest Accrued .+', text)
    required_line = required_line_match.group(0)
    details['Required Line'] = required_line

    # Extract specific details from the required line
    line_parts = required_line.split()
    details['Last Date'] = ' '.join(line_parts[:2])
    details['Interest Based Balance'] = line_parts[4]
    details['Interest Rate'] = f"{float(line_parts[5])/1000000:.6%}"

    return details

# Extract details
extracted_details = extract_details(text)

# Print the extracted details
print(extracted_details)
