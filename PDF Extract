import re
from datetime import datetime

# Given text
text = """
ACCOUNT NAME GOKUL ACCOUNT NUMBER 0012345678 ACCOUNT TYPE DEMAND DEPOSIT ACCOUNTSTATEMENT DATE 01 MAR 2024 CURRENCY AUD INTEREST PERIOD 1 MAR 2024 TO 31 MAR 2024 STATEMENT NUMBER 00155 PAGE NUMBER 3 of 3 TAXID Interest Statement 30 MAR Interest Accrued 14900000 0100000 163 31 MAR Interest Accrued 50000000 0100000 163
"""

# Function to extract information
def extract_information(text):
    # Extract Account Name
    account_name = re.search(r'ACCOUNT NAME (\w+)', text).group(1)
    
    # Extract Account Number
    account_number = re.search(r'ACCOUNT NUMBER (\d+)', text).group(1)
    
    # Extract Account Type
    account_type = re.search(r'ACCOUNT TYPE (.+?) ACCOUNTSTATEMENT DATE', text).group(1).strip()
    
    # Extract Statement Date
    statement_date = re.search(r'DATE (\d{2} \w{3} \d{4})', text).group(1)
    
    # Extract Currency
    currency = re.search(r'CURRENCY (\w+)', text).group(1)
    
    # Extract Interest Period
    interest_period = re.search(r'INTEREST PERIOD (.+?) TO (.+?) STATEMENT NUMBER', text)
    interest_period_start = interest_period.group(1)
    interest_period_end = interest_period.group(2)
    interest_period_end_short = ' '.join(interest_period_end.split()[:2])
    
    # Extract the line with the keyword from 6c
    line_with_keyword = re.search(rf'.*{interest_period_end_short}.*', text).group(0)
    
    # Extract late date from the line
    late_date = re.search(r'^\d{2} \w{3}', line_with_keyword).group(0)
    
    # Extract Interest Based Balance, Interest Rate and transform Interest Rate
    interest_based_balance = re.search(r'Interest Accrued (\d+)', line_with_keyword).group(1)
    interest_rate = re.search(r'Interest Accrued \d+ (\d+)', line_with_keyword).group(1)
    interest_rate_transformed = f"{int(interest_rate)/1000000:.6f}%"
    
    # Create the dictionary
    extracted_info = {
        "Account Name": account_name,
        "Account Number": account_number,
        "Account Type": account_type,
        "Statement Date": statement_date,
        "Currency": currency,
        "Interest Period": {
            "Start Date": interest_period_start,
            "End Date": interest_period_end,
            "End Date Short": interest_period_end_short
        },
        "Line with Keyword": line_with_keyword,
        "Late Date": late_date,
        "Interest Based Balance": interest_based_balance,
        "Interest Rate": interest_rate_transformed
    }
    
    return extracted_info

# Extract the information
extracted_info = extract_information(text)

# Print the results
print(extracted_info)
