import pdfplumber
import pandas as pd
import re

# Function to extract tables and text from PDF
def extract_tables_and_text(pdf_path):
    with pdfplumber.open(pdf_path) as pdf:
        tables = []
        for page in pdf.pages:
            text = page.extract_text()
            page_tables = page.extract_tables()
            tables.append((text, page_tables))
    return tables

# Function to extract dataframe names and assign to tables
def process_tables(tables):
    dataframes = {}
    for page_text, page_tables in tables:
        lines = page_text.split('\n')
        for i, line in enumerate(lines):
            if re.match(r'^(23MY|24MY)', line):
                df_name = line.strip()
                if i+1 < len(lines):
                    for table in page_tables:
                        df = pd.DataFrame(table[1:], columns=table[0])
                        dataframes[df_name] = df
                        break
    return dataframes

# Path to the PDF file
pdf_path = 'your_pdf_file.pdf'

# Extract tables and text
tables_and_text = extract_tables_and_text(pdf_path)

# Process tables to get named dataframes
named_dataframes = process_tables(tables_and_text)

# Display the named dataframes
for name, df in named_dataframes.items():
    print(f"DataFrame Name: {name}")
    print(df)
    print("\n")
